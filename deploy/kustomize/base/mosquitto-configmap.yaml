apiVersion: v1
kind: ConfigMap
metadata:
  name: mosquitto-config
  namespace: iiot
  labels:
    app.kubernetes.io/name: mosquitto
    app.kubernetes.io/part-of: iiot-edge-platform
data:
  mosquitto.conf: |
    # Mosquitto broker configuration â€” development/local cluster.
    # WARNING: allow_anonymous is intentionally enabled for dev; disable in production.

    allow_anonymous true

    # Standard MQTT listener
    listener 1883 0.0.0.0
    protocol mqtt

    # Disable persistence (in-memory only; messages lost on restart).
    # For production replace with a StatefulSet + PersistentVolumeClaim.
    persistence false

    # Log to stdout so the kubelet can capture it via kubectl logs
    log_dest stdout
    log_type all
